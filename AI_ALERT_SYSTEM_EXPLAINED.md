# ğŸ§  Fintastic AI & Alert System - Complete Flow Explanation

## Table of Contents
1. [System Architecture Overview](#system-architecture-overview)
2. [Alert System Flow (Backend)](#alert-system-flow-backend)
3. [AI Service Flow (Python)](#ai-service-flow-python)
4. [End-to-End Transaction Flow](#end-to-end-transaction-flow)
5. [Key Components Deep Dive](#key-components-deep-dive)
6. [Important Details You Must Know](#important-details-you-must-know)

---

## System Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND (React)                         â”‚
â”‚  - User adds transaction                                         â”‚
â”‚  - Displays alerts & insights                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND (Node.js/Express)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1. Transaction Controller                                 â”‚  â”‚
â”‚  â”‚    - Receives transaction                                 â”‚  â”‚
â”‚  â”‚    - Saves to MongoDB                                     â”‚  â”‚
â”‚  â”‚    - Triggers alert engine                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                 â”‚                                                â”‚
â”‚                 â–¼                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 2. Alert Engine (alert.utils.js)                         â”‚  â”‚
â”‚  â”‚    - Analyzes transaction                                 â”‚  â”‚
â”‚  â”‚    - Calculates risk scores                               â”‚  â”‚
â”‚  â”‚    - Decides: CREATE/UPDATE/SKIP alert                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                 â”‚                                                â”‚
â”‚                 â–¼                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 3. AiAlert Model (MongoDB)                                â”‚  â”‚
â”‚  â”‚    - Stores alert with metadata                           â”‚  â”‚
â”‚  â”‚    - Tracks trigger count, cooldowns                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                 â”‚                                                â”‚
â”‚                 â–¼                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 4. Calls AI Service                                       â”‚  â”‚
â”‚  â”‚    - POST /ai/insights                                    â”‚  â”‚
â”‚  â”‚    - Sends alert + stats + behavior                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   AI SERVICE (Python/FastAPI)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 5. Generate AI Insights                                   â”‚  â”‚
â”‚  â”‚    - Uses Groq LLM (llama-3.3-70b)                        â”‚  â”‚
â”‚  â”‚    - Generates personalized message                       â”‚  â”‚
â”‚  â”‚    - Stores in ChromaDB (vector memory)                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                 â”‚                                                â”‚
â”‚                 â–¼                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 6. ChromaDB (Vector Database)                             â”‚  â”‚
â”‚  â”‚    - Stores user memories                                 â”‚  â”‚
â”‚  â”‚    - Enables semantic search                              â”‚  â”‚
â”‚  â”‚    - Context for future insights                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Alert System Flow (Backend)

### ğŸ“ Key Files:
- `backend/src/utils/aiAlert.internal.js` - Alert creation/update logic
- `backend/src/utils/alert.utils.js` - Alert retrieval
- `backend/src/utils/classifyAlertArea.js` - Alert classification
- `backend/src/utils/resolveAlerts.internal.js` - Alert resolution
- `backend/src/models/AiAlert.js` - Alert data model

### ğŸ”„ Flow Diagram:

```
USER ADDS TRANSACTION
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. transactionController.js                                 â”‚
â”‚    - Validates transaction                                  â”‚
â”‚    - Saves to MongoDB                                       â”‚
â”‚    - Calculates user stats (income, expenses, savings)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. classifyAlertArea.js                                     â”‚
â”‚    - Determines alert scope (category/overall/goal)         â”‚
â”‚    - Creates areaInfo object:                               â”‚
â”‚      {                                                       â”‚
â”‚        scope: "category",                                   â”‚
â”‚        areaKey: "Food",                                     â”‚
â”‚        title: "Food Spending Alert",                        â”‚
â”‚        page: "expenses"                                     â”‚
â”‚      }                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Alert Decision Engine (aiAlert.internal.js)              â”‚
â”‚    Function: shouldCreateOrUpdateAlert()                    â”‚
â”‚                                                              â”‚
â”‚    Step 3a: Check for existing alert                        â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚    â”‚ Query MongoDB:                              â”‚          â”‚
â”‚    â”‚ - userId: user123                           â”‚          â”‚
â”‚    â”‚ - scope: "category"                         â”‚          â”‚
â”‚    â”‚ - areaKey: "Food"                           â”‚          â”‚
â”‚    â”‚ - status: "active"                          â”‚          â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                              â”‚
â”‚    Step 3b: Decision Logic                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚    â”‚ IF no existing alert:                       â”‚          â”‚
â”‚    â”‚   â†’ mode = "create"                         â”‚          â”‚
â”‚    â”‚                                              â”‚          â”‚
â”‚    â”‚ IF cooldown active:                         â”‚          â”‚
â”‚    â”‚   â†’ mode = "skip"                           â”‚          â”‚
â”‚    â”‚                                              â”‚          â”‚
â”‚    â”‚ IF risk score increased by 20+:             â”‚          â”‚
â”‚    â”‚   â†’ mode = "update"                         â”‚          â”‚
â”‚    â”‚                                              â”‚          â”‚
â”‚    â”‚ IF same level & reasons:                    â”‚          â”‚
â”‚    â”‚   â†’ mode = "skip"                           â”‚          â”‚
â”‚    â”‚                                              â”‚          â”‚
â”‚    â”‚ IF user ignores alerts (60%+ ignore rate):  â”‚          â”‚
â”‚    â”‚   â†’ Be LESS sensitive (skip more)           â”‚          â”‚
â”‚    â”‚                                              â”‚          â”‚
â”‚    â”‚ IF user resolves alerts (50%+ resolve rate):â”‚          â”‚
â”‚    â”‚   â†’ Be MORE sensitive (update more)         â”‚          â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Create or Update Alert                                   â”‚
â”‚    Function: createOrUpdateAiAlert()                        â”‚
â”‚                                                              â”‚
â”‚    IF mode = "create":                                      â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚    â”‚ Create new AiAlert document:                â”‚          â”‚
â”‚    â”‚ {                                            â”‚          â”‚
â”‚    â”‚   userId: ObjectId,                         â”‚          â”‚
â”‚    â”‚   scope: "category",                        â”‚          â”‚
â”‚    â”‚   areaKey: "Food",                          â”‚          â”‚
â”‚    â”‚   level: "HIGH",                            â”‚          â”‚
â”‚    â”‚   status: "active",                         â”‚          â”‚
â”‚    â”‚   triggerCount: 1,                          â”‚          â”‚
â”‚    â”‚   lastRiskScore: 75,                        â”‚          â”‚
â”‚    â”‚   lastPositivityScore: 20,                  â”‚          â”‚
â”‚    â”‚   coolDownUntil: Date (3 days from now),   â”‚          â”‚
â”‚    â”‚   title: "Food Spending Alert",             â”‚          â”‚
â”‚    â”‚   page: "expenses",                         â”‚          â”‚
â”‚    â”‚   meta: {                                    â”‚          â”‚
â”‚    â”‚     lastReasons: ["Spent 40% over budget"], â”‚          â”‚
â”‚    â”‚     lastCategory: "Food",                   â”‚          â”‚
â”‚    â”‚     lastAmount: 15000,                      â”‚          â”‚
â”‚    â”‚     statsSnapshot: {...}                    â”‚          â”‚
â”‚    â”‚   }                                          â”‚          â”‚
â”‚    â”‚ }                                            â”‚          â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                              â”‚
â”‚    IF mode = "update":                                      â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚    â”‚ Update existing alert:                      â”‚          â”‚
â”‚    â”‚ - Increment triggerCount                    â”‚          â”‚
â”‚    â”‚ - Update lastRiskScore                      â”‚          â”‚
â”‚    â”‚ - Update lastTriggeredAt                    â”‚          â”‚
â”‚    â”‚ - Reset coolDownUntil                       â”‚          â”‚
â”‚    â”‚ - Update meta.lastReasons                   â”‚          â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Call AI Service for Insights                             â”‚
â”‚    POST http://localhost:8001/ai/insights                   â”‚
â”‚                                                              â”‚
â”‚    Request Body:                                             â”‚
â”‚    {                                                         â”‚
â”‚      userId: "user123",                                     â”‚
â”‚      alert: {                                                â”‚
â”‚        id: "alert_id",                                      â”‚
â”‚        level: "HIGH",                                       â”‚
â”‚        scope: "category",                                   â”‚
â”‚        title: "Food Spending Alert",                        â”‚
â”‚        reasons: ["Spent 40% over budget"]                   â”‚
â”‚      },                                                      â”‚
â”‚      stats: {                                                â”‚
â”‚        monthlyIncome: 50000,                                â”‚
â”‚        monthlyExpense: 45000,                               â”‚
â”‚        savingsRate: 10                                      â”‚
â”‚      },                                                      â”‚
â”‚      goals: [...],                                          â”‚
â”‚      behaviorProfile: {                                     â”‚
â”‚        disciplineScore: 60,                                 â”‚
â”‚        impulseScore: 70,                                    â”‚
â”‚        riskIndex: 50                                        â”‚
â”‚      },                                                      â”‚
â”‚      dataConfidence: "high"                                 â”‚
â”‚    }                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ¯ Alert Levels & Cooldowns:

| Level    | Risk Score Range | Cooldown Period | Use Case                          |
|----------|------------------|-----------------|-----------------------------------|
| POSITIVE | N/A              | 1 day           | Good behavior (savings, goals)    |
| MEDIUM   | 30-60            | 1 day           | Minor overspending                |
| HIGH     | 60-80            | 3 days          | Significant overspending          |
| CRITICAL | 80-100           | 7 days          | Severe financial risk             |

### ğŸ§® Risk Score Calculation Example:

```javascript
// Example: Food category spending
const budgetLimit = 10000;  // User's budget for Food
const actualSpent = 15000;  // User spent â‚¹15,000
const overBudget = actualSpent - budgetLimit;  // â‚¹5,000 over
const overPercentage = (overBudget / budgetLimit) * 100;  // 50% over

// Risk score calculation
let riskScore = 0;
if (overPercentage > 50) riskScore = 80;  // CRITICAL
else if (overPercentage > 30) riskScore = 70;  // HIGH
else if (overPercentage > 15) riskScore = 50;  // MEDIUM

// Result: level = "CRITICAL", riskScore = 80
```

---

## AI Service Flow (Python)

### ğŸ“ Key Files:
- `ai-service/main.py` - Main FastAPI application
- `ai-service/node_client.py` - Node.js backend integration
- `ai-service/transaction_service.py` - Transaction classification

### ğŸ”„ Flow Diagram:

```
BACKEND CALLS AI SERVICE
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. POST /ai/insights Endpoint                               â”‚
â”‚    - Receives InsightRequest                                â”‚
â”‚    - Extracts: userId, alert, stats, goals, behavior        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Build Context for LLM                                    â”‚
â”‚                                                              â”‚
â”‚    a) Alert Context:                                        â”‚
â”‚       "ALERT CONTEXT                                        â”‚
â”‚        --------------                                        â”‚
â”‚        Level: HIGH                                          â”‚
â”‚        Scope: category                                      â”‚
â”‚        Title: Food Spending Alert                           â”‚
â”‚        Reasons:                                             â”‚
â”‚        - Spent 40% over budget"                             â”‚
â”‚                                                              â”‚
â”‚    b) Stats Context:                                        â”‚
â”‚       "CURRENT STATS                                        â”‚
â”‚        --------------                                        â”‚
â”‚        Monthly Income: â‚¹50,000                              â”‚
â”‚        Monthly Expense: â‚¹45,000                             â”‚
â”‚        Savings Rate: 10%                                    â”‚
â”‚        Investment Rate: 5%                                  â”‚
â”‚        Net Worth: â‚¹100,000"                                 â”‚
â”‚                                                              â”‚
â”‚    c) Behavior Context:                                     â”‚
â”‚       "BEHAVIOR PROFILE                                     â”‚
â”‚        --------------                                        â”‚
â”‚        Discipline: 60/100                                   â”‚
â”‚        Impulse: 70/100                                      â”‚
â”‚        Consistency: 55/100                                  â”‚
â”‚        Risk: 50/100"                                        â”‚
â”‚                                                              â”‚
â”‚    d) Goals Context:                                        â”‚
â”‚       [                                                      â”‚
â”‚         {                                                    â”‚
â”‚           name: "Laptop",                                   â”‚
â”‚           targetAmount: 80000,                              â”‚
â”‚           currentAmount: 20000,                             â”‚
â”‚           deadline: "2024-12-31"                            â”‚
â”‚         }                                                    â”‚
â”‚       ]                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Generate System Prompt                                   â”‚
â”‚                                                              â”‚
â”‚    "You are Fintastic AI â€” a professional financial         â”‚
â”‚     communication and coaching engine.                      â”‚
â”‚                                                              â”‚
â”‚     IMPORTANT:                                              â”‚
â”‚     - You are NOT the decision maker.                       â”‚
â”‚     - The alert system has ALREADY evaluated the situation. â”‚
â”‚     - The alert and stats below are the SINGLE SOURCE OF    â”‚
â”‚       TRUTH.                                                â”‚
â”‚     - You MUST NOT invent or guess any numbers.             â”‚
â”‚                                                              â”‚
â”‚     [Alert Context]                                         â”‚
â”‚     [Stats Context]                                         â”‚
â”‚     [Goals Context]                                         â”‚
â”‚     [Behavior Context]                                      â”‚
â”‚                                                              â”‚
â”‚     INSTRUCTIONS:                                           â”‚
â”‚     - Explain what the alert means in simple language.      â”‚
â”‚     - Highlight ONE realistic positive angle (if any).      â”‚
â”‚     - Highlight ONE key area to improve.                    â”‚
â”‚     - Suggest ONE specific, practical next action.          â”‚
â”‚     - Use a supportive, analytical tone (never shaming).    â”‚
â”‚     - Use â‚¹ when mentioning money.                          â”‚
â”‚                                                              â”‚
â”‚     Return ONLY valid JSON in this EXACT shape:             â”‚
â”‚     {                                                        â”‚
â”‚       'title': 'Food Spending Alert',                       â”‚
â”‚       'ai_noticing': '',                                    â”‚
â”‚       'positive': '',                                       â”‚
â”‚       'improvement': '',                                    â”‚
â”‚       'action': ''                                          â”‚
â”‚     }"                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Call Groq LLM API                                        â”‚
â”‚    Model: llama-3.3-70b-versatile                           â”‚
â”‚    Temperature: 0.2 (low randomness)                        â”‚
â”‚                                                              â”‚
â”‚    await client.chat.completions.create(                    â”‚
â”‚      model="llama-3.3-70b-versatile",                       â”‚
â”‚      temperature=0.2,                                       â”‚
â”‚      messages=[                                             â”‚
â”‚        {"role": "system", "content": system_prompt},        â”‚
â”‚        {"role": "user", "content": "Generate JSON now"}     â”‚
â”‚      ]                                                       â”‚
â”‚    )                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Parse LLM Response                                       â”‚
â”‚                                                              â”‚
â”‚    Raw Response:                                            â”‚
â”‚    {                                                         â”‚
â”‚      "title": "Food Spending Alert",                        â”‚
â”‚      "ai_noticing": "You've spent â‚¹15,000 on Food this      â”‚
â”‚                      month, which is 50% over your typical  â”‚
â”‚                      budget of â‚¹10,000.",                   â”‚
â”‚      "positive": "You're tracking your expenses, which is   â”‚
â”‚                   the first step to better control.",       â”‚
â”‚      "improvement": "Reduce dining out and cook at home     â”‚
â”‚                      more often to save â‚¹5,000/month.",     â”‚
â”‚      "action": "Set a weekly Food budget of â‚¹2,500 and      â”‚
â”‚                 track it daily using the app."              â”‚
â”‚    }                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. Store in ChromaDB (Vector Memory)                        â”‚
â”‚                                                              â”‚
â”‚    Function: store_memory_entry()                           â”‚
â”‚                                                              â”‚
â”‚    Content:                                                  â”‚
â”‚    "ALERT: Food Spending Alert (HIGH)                       â”‚
â”‚     User spent â‚¹15,000 on Food, 50% over budget.            â”‚
â”‚     Recommended: Reduce dining out, set weekly budget."     â”‚
â”‚                                                              â”‚
â”‚    Metadata:                                                 â”‚
â”‚    {                                                         â”‚
â”‚      userId: "user123",                                     â”‚
â”‚      type: "daily_activity",                                â”‚
â”‚      importance: "high",                                    â”‚
â”‚      source: "ai",                                          â”‚
â”‚      date: "2024-11-27",                                    â”‚
â”‚      level: "HIGH",                                         â”‚
â”‚      category: "Food"                                       â”‚
â”‚    }                                                         â”‚
â”‚                                                              â”‚
â”‚    â†’ Generates embedding vector using SentenceTransformer   â”‚
â”‚    â†’ Stores in ChromaDB for future semantic search          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. Return Response to Backend                               â”‚
â”‚                                                              â”‚
â”‚    {                                                         â”‚
â”‚      "success": true,                                       â”‚
â”‚      "userId": "user123",                                   â”‚
â”‚      "alertId": "alert_id",                                 â”‚
â”‚      "page": "expenses",                                    â”‚
â”‚      "insight": {                                            â”‚
â”‚        "title": "Food Spending Alert",                      â”‚
â”‚        "ai_noticing": "...",                                â”‚
â”‚        "positive": "...",                                   â”‚
â”‚        "improvement": "...",                                â”‚
â”‚        "action": "..."                                      â”‚
â”‚      }                                                       â”‚
â”‚    }                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ§  ChromaDB Memory System:

ChromaDB stores user memories as **vector embeddings** for semantic search.

**Memory Types** (5 standardized categories):
1. `onboarding_profile` - User profile, income patterns, investment preferences
2. `daily_activity` - Spending alerts, positive behaviors, daily mentor messages
3. `behavior_pattern` - Chat behavior, decision patterns
4. `decision_history` - Stock analysis, SIP recommendations, insurance advice
5. `goal_progress` - Goal achievements, progress updates
6. `market_intelligence` - Market trends, crash risk assessments
7. `market_alert` - High/extreme crash risk alerts

**Example Memory Storage:**
```python
# When user asks "Should I buy Zomato stock?"
store_memory_entry(
    user_id="user123",
    content="User asked about Zomato stock. Current price: â‚¹302.75. "
            "Recommendation: HOLD. Reason: High P/E ratio (1614), "
            "suitable for high-risk investors only.",
    mem_type="decision_history",
    metadata={
        "symbol": "Zomato",
        "kind": "stock",
        "decision": "HOLD",
        "source": "ai"
    }
)
```

**Semantic Search Example:**
```python
# Later, when user asks "What did you say about stocks?"
query_user_memories(
    user_id="user123",
    query="stock recommendations",
    top_k=5
)
# Returns: Previous Zomato analysis + other stock-related memories
```

---

## End-to-End Transaction Flow

### Complete Example: User Spends â‚¹5,000 on Food

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 1: User Action (Frontend)                              â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ User clicks "Add Transaction"                               â”‚
â”‚ Fills form:                                                  â”‚
â”‚   - Type: Expense                                           â”‚
â”‚   - Category: Food                                          â”‚
â”‚   - Amount: â‚¹5,000                                          â”‚
â”‚   - Note: "Dinner with friends"                             â”‚
â”‚ Clicks "Save"                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 2: Frontend API Call                                   â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ POST /api/transactions                                      â”‚
â”‚ {                                                            â”‚
â”‚   type: "expense",                                          â”‚
â”‚   category: "Food",                                         â”‚
â”‚   amount: 5000,                                             â”‚
â”‚   note: "Dinner with friends"                               â”‚
â”‚ }                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 3: Backend - Transaction Controller                    â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ 1. Validate request                                         â”‚
â”‚ 2. Create Transaction document in MongoDB                   â”‚
â”‚ 3. Calculate updated user stats:                            â”‚
â”‚    - Total Food spending this month: â‚¹15,000               â”‚
â”‚    - Monthly expense: â‚¹45,000                               â”‚
â”‚    - Savings rate: 10%                                      â”‚
â”‚ 4. Check if alert should be triggered                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 4: Alert Classification                                â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ classifyAlertArea() determines:                             â”‚
â”‚   - scope: "category" (Food category alert)                â”‚
â”‚   - areaKey: "Food"                                         â”‚
â”‚   - title: "Food Spending Alert"                            â”‚
â”‚   - page: "expenses"                                        â”‚
â”‚                                                              â”‚
â”‚ Calculate risk:                                             â”‚
â”‚   - Budget: â‚¹10,000                                         â”‚
â”‚   - Spent: â‚¹15,000                                          â”‚
â”‚   - Over: 50%                                               â”‚
â”‚   - Risk Score: 75 (HIGH)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 5: Alert Decision Engine                               â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ shouldCreateOrUpdateAlert() checks:                         â”‚
â”‚   1. Existing alert? YES (found Food alert from 2 days ago) â”‚
â”‚   2. Cooldown active? NO (expired)                          â”‚
â”‚   3. Risk increased? YES (was 60, now 75 â†’ +15)            â”‚
â”‚   4. Decision: UPDATE                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 6: Update Alert in MongoDB                             â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ AiAlert.findOneAndUpdate({                                  â”‚
â”‚   userId: user123,                                          â”‚
â”‚   scope: "category",                                        â”‚
â”‚   areaKey: "Food"                                           â”‚
â”‚ }, {                                                         â”‚
â”‚   $set: {                                                    â”‚
â”‚     level: "HIGH",                                          â”‚
â”‚     lastRiskScore: 75,                                      â”‚
â”‚     lastTriggeredAt: new Date(),                            â”‚
â”‚     coolDownUntil: new Date(+3 days),                       â”‚
â”‚     meta: {                                                  â”‚
â”‚       lastReasons: ["Spent 50% over budget"],               â”‚
â”‚       lastAmount: 5000,                                     â”‚
â”‚       statsSnapshot: {...}                                  â”‚
â”‚     }                                                        â”‚
â”‚   },                                                         â”‚
â”‚   $inc: { triggerCount: 1 }                                 â”‚
â”‚ })                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 7: Call AI Service                                     â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ POST http://localhost:8001/ai/insights                      â”‚
â”‚ {                                                            â”‚
â”‚   userId: "user123",                                        â”‚
â”‚   alert: {                                                   â”‚
â”‚     id: "alert_id",                                         â”‚
â”‚     level: "HIGH",                                          â”‚
â”‚     scope: "category",                                      â”‚
â”‚     title: "Food Spending Alert",                           â”‚
â”‚     reasons: ["Spent 50% over budget"]                      â”‚
â”‚   },                                                         â”‚
â”‚   stats: { monthlyIncome: 50000, ... },                    â”‚
â”‚   behaviorProfile: { disciplineScore: 60, ... }             â”‚
â”‚ }                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 8: AI Generates Insight                                â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ Groq LLM (llama-3.3-70b) generates:                         â”‚
â”‚ {                                                            â”‚
â”‚   "title": "Food Spending Alert",                           â”‚
â”‚   "ai_noticing": "You've spent â‚¹15,000 on Food this month,  â”‚
â”‚                   which is 50% over your typical budget of  â”‚
â”‚                   â‚¹10,000. This is affecting your savings   â”‚
â”‚                   goal for the Laptop.",                    â”‚
â”‚   "positive": "You're consistently tracking expenses, which â”‚
â”‚                shows financial awareness.",                 â”‚
â”‚   "improvement": "Reduce dining out frequency. Cooking at   â”‚
â”‚                   home 3 more times per week could save     â”‚
â”‚                   â‚¹5,000/month.",                           â”‚
â”‚   "action": "Set a weekly Food budget of â‚¹2,500 and use    â”‚
â”‚              the app's budget tracker to monitor it daily." â”‚
â”‚ }                                                            â”‚
â”‚                                                              â”‚
â”‚ â†’ Stores in ChromaDB for future context                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 9: Backend Receives Insight                            â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ Updates AiAlert with AI-generated insight                   â”‚
â”‚ Returns response to frontend                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STEP 10: Frontend Displays Alert                            â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ Dashboard shows:                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ ğŸ”´ Food Spending Alert (HIGH)                            â”‚â”‚
â”‚ â”‚                                                           â”‚â”‚
â”‚ â”‚ ğŸ“Š AI Noticing:                                          â”‚â”‚
â”‚ â”‚ You've spent â‚¹15,000 on Food this month, which is 50%   â”‚â”‚
â”‚ â”‚ over your typical budget of â‚¹10,000...                  â”‚â”‚
â”‚ â”‚                                                           â”‚â”‚
â”‚ â”‚ âœ… Positive:                                             â”‚â”‚
â”‚ â”‚ You're consistently tracking expenses...                â”‚â”‚
â”‚ â”‚                                                           â”‚â”‚
â”‚ â”‚ ğŸ’¡ Improvement:                                          â”‚â”‚
â”‚ â”‚ Reduce dining out frequency...                          â”‚â”‚
â”‚ â”‚                                                           â”‚â”‚
â”‚ â”‚ ğŸ¯ Action:                                               â”‚â”‚
â”‚ â”‚ Set a weekly Food budget of â‚¹2,500...                   â”‚â”‚
â”‚ â”‚                                                           â”‚â”‚
â”‚ â”‚ [Dismiss] [Mark as Resolved]                             â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Key Components Deep Dive

### 1. Alert Model Schema (MongoDB)

```javascript
// backend/src/models/AiAlert.js
{
  userId: ObjectId,              // User reference
  scope: String,                 // "category" | "overall" | "goal"
  areaKey: String,               // "Food" | "overall" | "Laptop"
  status: String,                // "active" | "resolved" | "ignored"
  level: String,                 // "POSITIVE" | "MEDIUM" | "HIGH" | "CRITICAL"
  
  // Tracking
  triggerCount: Number,          // How many times this alert was triggered
  resolvedCount: Number,         // How many times user resolved it
  ignoredCount: Number,          // How many times user ignored it
  
  // Risk Scores
  lastRiskScore: Number,         // 0-100 (current risk level)
  lastPositivityScore: Number,   // 0-100 (for positive alerts)
  
  // Timing
  lastTriggeredAt: Date,         // When alert was last triggered
  coolDownUntil: Date,           // Don't trigger again until this date
  
  // Display
  title: String,                 // "Food Spending Alert"
  page: String,                  // "expenses" | "dashboard" | "goals"
  
  // Transaction Reference
  lastTransactionId: ObjectId,   // Last transaction that triggered this
  
  // Metadata
  meta: {
    lastReasons: [String],       // ["Spent 50% over budget"]
    lastCategory: String,        // "Food"
    lastAmount: Number,          // 5000
    statsSnapshot: {             // User stats at time of alert
      monthlyIncome: Number,
      monthlyExpense: Number,
      savingsRate: Number,
      investmentRate: Number,
      netWorth: Number
    }
  }
}
```

### 2. ChromaDB Memory Schema

```python
# ai-service/main.py
{
  "id": "user123_daily_activity_a1b2c3d4",  # Unique ID
  "embedding": [0.123, -0.456, ...],         # 384-dim vector
  "metadata": {
    "userId": "user123",
    "type": "daily_activity",                # Standardized type
    "content": "Alert: Food Spending...",    # Full text content
    "source": "ai",                          # "ai" | "user" | "system"
    "date": "2024-11-27",
    "importance": "high",                    # "low" | "medium" | "high"
    "originalType": "spending_alert",        # Original type before mapping
    
    # Alert-specific metadata
    "level": "HIGH",
    "category": "Food",
    "riskScore": 75
  },
  "document": "ALERT: Food Spending Alert (HIGH)..."  # Searchable text
}
```

### 3. AI Chat System (Conversational AI)

The AI service also handles chat interactions:

```python
# POST /ai/chat
{
  "userId": "user123",
  "message": "Should I invest in Zomato?",
  "chatHistory": [...],
  "relevantMemories": [...],
  "behaviorProfile": {...}
}

# AI decides which tool to use:
# - market_data: Fetch stock price & analysis
# - sip_recommender: SIP fund recommendations
# - insurance_matcher: Insurance recommendations
# - add_transaction: Add transaction to DB
# - create_goal: Create financial goal
# - tavily_search: Web search for general queries
# - general_chat: Conversational response

# Returns plan:
{
  "intent": "investment_advice",
  "needs_confirmation": false,
  "tool": "market_data",
  "params": {
    "symbol": "Zomato",
    "riskLevel": "medium",
    "investmentHorizon": "long-term"
  },
  "response_to_user": "Let me check Zomato's current market data..."
}
```

### 4. Market Intelligence Tools

The AI service has market-aware capabilities:

```python
# 1. market_overview() - Get market trends
{
  "nifty": "19,500",
  "sensex": "65,000",
  "vix": "15.2",
  "trend": "bullish",           # bullish | bearish | volatile
  "global_sentiment": "positive",
  "top_news": [...],
  "sector_trends": {...}
}

# 2. crash_risk_detector() - Assess crash probability
{
  "crash_probability_percent": 25,
  "severity": "medium",         # low | medium | high | extreme
  "recommended_user_action": "Monitor market closely...",
  "reasoning": "VIX at 15.2, market trend bullish..."
}

# 3. investment_signal_engine() - Generate signals
{
  "signal": "BUY",              # BUY | HOLD | WAIT | REDUCE_RISK
  "asset_type": "index",        # index | balanced | equity | debt
  "recommended_amount": 5000,
  "justification": "Bullish market, user has low risk profile..."
}

# 4. sip_forecast() - SIP recommendations
{
  "recommended_sip_amount": 3000,
  "suggested_funds": ["index", "large_cap", "debt"],
  "ideal_execution_day_range": "1-7 (standard)",
  "risk_adjustment_notes": [...]
}
```

---

## Important Details You Must Know

### ğŸ”¥ Critical Concepts

#### 1. **Alert Cooldown System**
- **Purpose**: Prevent alert spam
- **How it works**: After an alert is triggered, it won't trigger again until cooldown expires
- **Cooldown periods**:
  - POSITIVE: 1 day
  - MEDIUM: 1 day
  - HIGH: 3 days
  - CRITICAL: 7 days
- **Exception**: CRITICAL alerts can re-trigger within 24h if risk increases significantly

#### 2. **Reinforcement Learning**
The system learns from user behavior:
- **High ignore rate (60%+)**: System becomes LESS sensitive
  - Requires +30 risk score increase to update alert
- **High resolve rate (50%+)**: System becomes MORE sensitive
  - Updates alert with just +5 risk score increase
- **Purpose**: Adapt to user's engagement level

#### 3. **Data Confidence Levels**
AI insights adapt based on data availability:
- **LOW**: Few transactions, relies on onboarding data
  - AI explicitly mentions data limitations
  - Gives generic, safe advice
- **MEDIUM**: Some transaction history
  - Conservative conclusions
  - Focuses on current transaction
- **HIGH**: Rich transaction history
  - Pattern-based suggestions
  - Stronger recommendations

#### 4. **Gig Worker Detection**
System automatically detects gig/freelance workers:
- **Detection**: Checks for keywords in income transactions
  - "freelance", "gig", "contractor", "consulting", "commission"
- **Impact on advice**:
  - Recommends 6-month emergency fund (vs 3 months)
  - More conservative spending limits
  - Accounts for income irregularity
  - Different investment recommendations

#### 5. **Memory Type Mapping**
All memories are standardized to 5 types:
```python
TYPE_MAPPING = {
  "general" â†’ "onboarding_profile",
  "income_pattern" â†’ "onboarding_profile",
  "spending_alert" â†’ "daily_activity",
  "chat_behavior" â†’ "behavior_pattern",
  "decision_history" â†’ "decision_history",
  "goal_progress" â†’ "goal_progress",
  "market_intelligence" â†’ "market_intelligence",
  "market_alert" â†’ "market_alert"
}
```

#### 6. **Alert Scope Types**
- **category**: Specific category overspending (e.g., Food, Transport)
- **overall**: Overall financial health (e.g., low savings rate)
- **goal**: Goal-related alerts (e.g., goal deadline approaching)

#### 7. **Risk Score Calculation**
Risk scores (0-100) determine alert level:
- **0-30**: No alert (normal behavior)
- **30-60**: MEDIUM alert
- **60-80**: HIGH alert
- **80-100**: CRITICAL alert

Factors affecting risk score:
- Percentage over budget
- Frequency of overspending
- Impact on savings rate
- Impact on goals
- Income stability (gig workers = higher risk)

#### 8. **ChromaDB Semantic Search**
- Uses `SentenceTransformer("all-MiniLM-L6-v2")` for embeddings
- 384-dimensional vectors
- Cosine similarity for search
- **Example**:
  ```python
  # User asks: "What did you say about my spending?"
  # System searches for semantically similar memories:
  # - "Food spending alert: â‚¹15,000 over budget"
  # - "Transport expenses increased by 30%"
  # - "Positive: Saved â‚¹5,000 this month"
  ```

#### 9. **AI Service Rate Limiting**
- Uses Groq API (free tier has limits)
- **Fallback behavior** on rate limit:
  - Returns generic insight based on alert data
  - No LLM call required
  - Still provides value to user
  - Example: "This HIGH alert in Food requires attention. Review your spending patterns."

#### 10. **Transaction Classification**
AI service can classify transactions:
```python
# POST /classify
{
  "amount": 5000,
  "description": "Dinner at restaurant"
}

# Returns:
{
  "category": "Food",
  "type": "expense",
  "confidence": 0.95,
  "subcategory": "Dining Out"
}
```

### ğŸ› ï¸ Technical Stack Summary

| Component | Technology | Purpose |
|-----------|-----------|---------|
| **Backend** | Node.js + Express | API server, business logic |
| **Database** | MongoDB | User data, transactions, alerts |
| **AI Service** | Python + FastAPI | LLM integration, insights |
| **LLM** | Groq (llama-3.3-70b) | Natural language generation |
| **Vector DB** | ChromaDB | Semantic memory storage |
| **Embeddings** | SentenceTransformer | Text â†’ vector conversion |
| **Web Search** | Tavily API | Real-time market data |
| **Frontend** | React + TypeScript | User interface |

### ğŸ”„ Data Flow Summary

```
User Action â†’ Frontend â†’ Backend â†’ MongoDB
                           â†“
                    Alert Engine
                           â†“
                    AI Service â†’ Groq LLM
                           â†“
                      ChromaDB
                           â†“
                    Backend â†’ Frontend â†’ User
```

### ğŸ“Š Performance Considerations

1. **Alert Cooldowns**: Reduce DB queries and API calls
2. **Memory Caching**: ChromaDB stores embeddings for fast retrieval
3. **Batch Processing**: Multiple alerts can be processed together
4. **Async Operations**: AI service uses async/await for non-blocking I/O
5. **Rate Limiting**: Groq API has rate limits (handled with fallbacks)

### ğŸ” Security Notes

1. **Authentication**: JWT tokens for API access
2. **Internal Secrets**: `AI_INTERNAL_SECRET` for backend â†” AI service communication
3. **User Isolation**: All queries filtered by `userId`
4. **Data Privacy**: User data never leaves the system (except Groq API for insights)

---

## Quick Reference

### Key Endpoints

**Backend (Node.js)**
- `POST /api/transactions` - Add transaction
- `GET /api/alerts` - Get active alerts
- `POST /api/alerts/:id/resolve` - Resolve alert
- `GET /api/dashboard/latest` - Get latest financial data

**AI Service (Python)**
- `POST /ai/insights` - Generate AI insight for alert
- `POST /ai/chat` - Chat with AI assistant
- `POST /ai/execute` - Execute AI tool (add transaction, create goal, etc.)
- `POST /store-memory` - Store memory in ChromaDB
- `POST /search-memory` - Search memories semantically

### Environment Variables

**Backend (.env)**
```
MONGODB_URI=mongodb://localhost:27017/fintastic
JWT_SECRET=your_jwt_secret
AI_SERVICE_URL=http://localhost:8001
AI_INTERNAL_SECRET=your_internal_secret
```

**AI Service (.env)**
```
GROQ_API_KEY=your_groq_api_key
TAVILY_API_KEY=your_tavily_api_key
NODE_BACKEND_URL=http://localhost:3000
AI_INTERNAL_SECRET=your_internal_secret
```

---

## Conclusion

The Fintastic AI & Alert System is a sophisticated, context-aware financial coaching platform that:

1. **Monitors** user transactions in real-time
2. **Analyzes** spending patterns and financial health
3. **Generates** intelligent, personalized alerts
4. **Learns** from user behavior (reinforcement)
5. **Provides** actionable insights using LLM
6. **Remembers** context using vector embeddings
7. **Adapts** to user's financial situation (gig workers, risk profile, goals)

The system is designed to be **non-intrusive** (cooldowns), **intelligent** (reinforcement learning), and **helpful** (personalized insights), making it a true AI financial coach.
